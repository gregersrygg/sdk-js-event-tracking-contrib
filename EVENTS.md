# Events generated by JS-Snippet

## Introduction to the sub-objects

The events generated by the JS-SDK uses several sub-objects, some of them always present, while others are only used for certain types of events.

`@context` - This should always be present. It declares that the event is created in the context of SPT, and says sometihng about type and version of the API.

`@id` - A unique ID for the object. `@id` is also used inside sub-objects like `actor`, `object` and `provider`. The `@id` always refere to

## Page load

Page loads use the Activity Type `Read`. The `object` is the entity that are loaded.

```
"@context": [
    "http://www.w3.org/ns/activitystreams",
    {
        "spt": "http://spid.no",
        "spt:sdkType": "JS",
        "spt:sdkVersion": "0.1.0"
    }
],
"@id": "2a3e79df-62e0-49c9-af9f-f3be11fa356f",
"spt:pageViewId": "23a3155a-31e0-4399-907d-8ad6066ed405",
"published": "2015-03-26T13:26:31+01:00",
"actor": {
    "@type": "Person",
    "spt:userAgent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_3) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2272.104 Safari/537.36",
    "spt:screenSize": "1680x1050",
    "spt:viewportSize": "1313x502",
    "spt:acceptLanguage": "en-US",
    "@id": "urn:spid.no:person:a77e5b92-e6ee-4552-a207-ecc35b7e688a",
    "spt:environmentId": "urn:spid.no:environment:f0ccaba92013d32562ddce1105c3f70710af9e3b7e13009776ab746352b569b8",
    "spt:sessionId": "urn:spid.no:session:58d87b82-2518-45fd-a884-8b13157d7abe",
    "spt:remoteAddress": "127.0.0.1"
},
"provider": {
    "@type": "Organization",
    "@id": "urn:spid.no:2",
    "url": "http://127.0.0.1:8082/vg.html"
},
"@type": "Read",
"object": {
    "@type": "Page",
    "@id": "urn:127.0.0.1:page:1",
    "url": "http://127.0.0.1:8082/vg.html",
    "displayName": "Etterforskningsleder: Venter første svarene fra dødsflyets «svarte boks» i ettermiddag - Germanwings-styrten - VG",
    "spt:og": {
        ...
    },
    "spt:meta": {
        ...
    }
}
```

## Page Unload

Two events are generated on page unload. Please note that not all Page Unload events will be tracked, depending on factors such as page unload method and connection speed.

The first event is based on engagement time, it has the Activity Type `View` and a property `duration` that contains the time in milliseconds the user visited the page. The object here is the subject for the event. In other words the page that the user is leaving.

```
"@context": [
    "http://www.w3.org/ns/activitystreams",
    {
        "spt": "http://spid.no",
        "spt:sdkType": "JS",
        "spt:sdkVersion": "0.1.0"
    }
],
"@id": "502ee66e-369c-44ed-874e-e0848163c259",
"spt:pageViewId": "edbf9842-b125-4c31-b63f-57388c20a5a1",
"published": "2015-04-20T13:05:28+02:00",
"actor": {
    "@type": "Person",
    "@id": "urn:spid.no:person:a77e5b92-e6ee-4552-a207-ecc35b7e688a",
    "spt:environmentId": "urn:spid.no:environment:ec1df2d7d600247e67ec30ddfc26bf170c09dd782196939639be9f7d101f10ed",
    "spt:sessionId": "urn:spid.no:session:8c11e4aa-f6f1-43ec-a68b-63dab9e5c7aa",
    "spt:userId": "urn:spid.no:user:test123123",
    "spt:remoteAddress": "127.0.0.1"
},
"provider": {
    "@type": "Organization",
    "@id": "urn:spid.no:test",
    "url": "http://127.0.0.1:8082/index2.html"
},
"@type": "View",
"object": {
    "@type": "Page",
    "@id": "urn:127.0.0.1:page:test01",
    "url": "http://127.0.0.1:8082/index2.html",
    "displayName": "My first test site"
},
"duration": 8359
```

The second event is a event that indicates that the user has left the page. It uses the Activity Type `Leave` and `object` is the page that the user left. If the user left by clicking an a-element, there will be a `target`-object present that indicates where the user are going.

```
"@context": [
    "http://www.w3.org/ns/activitystreams",
    {
        "spt": "http://spid.no",
        "spt:sdkType": "JS",
        "spt:sdkVersion": "0.1.0"
    }
],
"@id": "aa2f8ef5-19c4-4aaf-8a46-f0c1976ac0fe",
"spt:pageViewId": "edbf9842-b125-4c31-b63f-57388c20a5a1",
"published": "2015-04-20T13:05:28+02:00",
"actor": {
    "@type": "Person",
    "@id": "urn:spid.no:person:a77e5b92-e6ee-4552-a207-ecc35b7e688a",
    "spt:environmentId": "urn:spid.no:environment:ec1df2d7d600247e67ec30ddfc26bf170c09dd782196939639be9f7d101f10ed",
    "spt:sessionId": "urn:spid.no:session:8c11e4aa-f6f1-43ec-a68b-63dab9e5c7aa",
    "spt:userId": "urn:spid.no:user:test123123",
    "spt:remoteAddress": "127.0.0.1"
},
"provider": {
    "@type": "Organization",
    "@id": "urn:spid.no:test",
    "url": "http://127.0.0.1:8082/index2.html"
},
"@type": "Leave",
"object": {
    "@type": "Page",
    "@id": "urn:127.0.0.1:page:test01",
    "url": "http://127.0.0.1:8082/index2.html",
    "displayName": "My first test site"
},
"target": {
    "@id": "urn:127.0.0.1:page:test01"
}

```
